(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(3660)}])},1371:function(e,t,r){"use strict";var l=r(5893);r(7294);var n=r(9361);let{useToken:i}=n.default;t.Z=()=>{let{token:e}=i();return(0,l.jsxs)("h1",{style:{color:e.colorTextInvert,margin:0},children:["UQ Study Oracle ",(0,l.jsx)("sup",{style:{fontSize:10},children:"BETA"})]})}},1198:function(e,t,r){"use strict";var l=r(5893);r(7294);var n=r(1664),i=r.n(n),s=r(9361),o=r(1371);let{useToken:a}=s.default;t.Z=()=>{let{token:e}=a();return(0,l.jsx)("header",{style:{backgroundColor:e.colorAccent},children:(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,l.jsx)(o.Z,{}),(0,l.jsx)("div",{style:{marginLeft:"auto",marginRight:16},children:(0,l.jsx)(i(),{href:"/about",children:(0,l.jsx)("div",{style:{color:"white"},children:"About"})})})]})})}},3660:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return A}});var l=r(5893),n=r(7294),i=r(1163),s=r(9008),o=r.n(s),a=r(1274),d=r(9361),c=r(1198),h=r(9356),u=r(3981),f=r(8073),x=r(532),y=r(4969),j=r(1664),g=r.n(j);let{useToken:p}=d.default;var m=e=>{let{collapsed:t,handleToggleSidebar:r,handleSelectedFile:i,dataSource:s,loading:o}=e,a=(0,n.useRef)(null),{token:d}=p();return(0,l.jsxs)("div",{style:{height:"100%",padding:"16px",display:"flex",flexDirection:"column",backgroundColor:d.colorSecondary,color:d.colorText},children:[(0,l.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:t?(0,l.jsx)(h.ZP,{type:"text",icon:(0,l.jsx)(f.Z,{}),onClick:r}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("h2",{style:{margin:0},children:"Data"}),(0,l.jsx)(h.ZP,{type:"text",icon:(0,l.jsx)(x.Z,{}),onClick:r})]})}),!t&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{style:{flex:1,overflowY:"auto",marginTop:10},children:!0==o?(0,l.jsx)("h3",{children:"Loading..."}):(0,l.jsx)(u.Z,{dataSource:s,renderItem:e=>(0,l.jsx)(u.Z.Item,{children:e}),bordered:!0})}),(0,l.jsx)(h.ZP,{type:"primary",danger:!0,style:{marginTop:10},children:(0,l.jsx)(g(),{href:"/about",children:"How to use?"})}),(0,l.jsxs)(h.ZP,{type:"primary",icon:(0,l.jsx)(y.Z,{}),style:{marginTop:10},onClick:()=>{try{a.current.click()}catch(e){console.error("Error opening file browser:",e)}},children:[(0,l.jsx)("input",{type:"file",style:{display:"none"},ref:a,onChange:e=>{i(e.target.files[0])}}),"Add File"]})]})]})};let{useToken:v}=d.default;var w=e=>{let{text:t,sender:r}=e,{token:n}=v(),i="me"===r;return(0,l.jsx)("div",{style:{backgroundColor:i?"#1890ff":"#f2f2f2",color:i?"white":"black",padding:10,marginBottom:10,borderRadius:5,alignSelf:i?"flex-end":"flex-start",maxWidth:"70%",display:"flex",alignItems:"center"},children:i?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{style:{marginRight:8,width:32,height:32,borderRadius:"50%",backgroundColor:"#1890ff"}}),(0,l.jsx)("div",{children:t})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{style:{marginLeft:8,width:32,height:32,borderRadius:"50%",backgroundColor:"#f2f2f2"}}),(0,l.jsx)("div",{children:t})]})})},b=e=>{let{chatHistory:t}=e;return(0,l.jsx)("div",{style:{flex:1,overflowY:"auto",marginBottom:20},children:t.map((e,t)=>(0,l.jsx)(w,{text:e.text,sender:e.sender},t))})},k=r(7917),C=e=>{let{message:t,handleMessageChange:r,handleSendMessage:n}=e;return(0,l.jsxs)("div",{style:{display:"flex"},children:[(0,l.jsx)(k.Z,{type:"text",value:t,onChange:r,placeholder:"Type your message...",style:{flex:1,borderRadius:5,marginRight:10}}),(0,l.jsx)(h.ZP,{type:"primary",onClick:n,children:"Send"})]})};r(6052);var S=r(8100);let{Header:T,Sider:Z,Content:_}=a.default,{useToken:P}=d.default;var A=function(){let{token:e}=P();(0,i.useRouter)();let[t,r]=(0,n.useState)(!1),[s,d]=(0,n.useState)(""),[h,u]=(0,n.useState)([]),[f,x]=(0,n.useState)(!1),[y,j]=(0,n.useState)([]),[p,v]=(0,n.useState)(!1),{user:w,isAuthenticated:k,isLoading:A}=(0,S.D3)();(0,n.useEffect)(()=>{console.log("isAuthenticated: ",k)},[]);let F=async e=>{let t=!1,r=0;for(;!t&&r<40;){let l=await fetch("/api/v1/task/".concat(e));200==(await l.json()).status&&(t=!0),await new Promise(e=>setTimeout(e,500)),r+=1}if(!t)return"Sorry, I couldn't answer this question due to some error.";let l=await fetch("/api/v1/task/".concat(e,"/result"));return(await l.json()).result},I=async()=>{if(""!==s.trim()){u([...h,{text:s,sender:"me"}]),d(""),x(!0);try{let e=await fetch("/api/v1/message",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:s})});if(e.ok){let t=await F((await e.json()).task_id);u(e=>[...e,{text:t,sender:"AI"}])}else console.error("API request failed")}catch(e){console.error("API request error:",e)}x(!1)}},L=()=>{r(!t)},O=async e=>{let t=0;for(;t<40;){let r=await fetch("/api/v1/task/".concat(e)),l=await r.json();if(200==l.status)return!0;await new Promise(e=>setTimeout(e,500)),t+=1}return!1},R=async e=>{if(v(!0),e)try{let t=new FormData;t.append("file",e);let r=await fetch("/api/v1//add_doc",{method:"POST",body:t});if(r.ok){let t=await O((await r.json()).task_id);t&&j(t=>[...t,e.name])}else alert("File Upload Failed!")}catch(e){console.error("File upload error:",e)}v(!1)};return(0,l.jsxs)("div",{style:{height:"100vh"},children:[(0,l.jsxs)(o(),{children:[(0,l.jsx)("title",{children:"Study Oracle"}),(0,l.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,l.jsxs)(a.default,{style:{height:"100vh"},children:[(0,l.jsxs)(T,{style:{backgroundColor:e.colorAccent},children:[(0,l.jsx)(c.Z,{}),k&&(0,l.jsx)(g(),{href:"/login",children:"Sign Out"})]}),(0,l.jsxs)(a.default,{style:{height:"calc(100% - 64px)"},children:[(0,l.jsx)(Z,{width:t?80:200,collapsible:!0,collapsed:t,onCollapse:L,children:(0,l.jsx)(m,{collapsed:t,handleToggleSidebar:L,handleSelectedFile:R,dataSource:y,loading:p})}),(0,l.jsx)(_,{style:{backgroundColor:e.colorBgBase},children:(0,l.jsxs)("div",{style:{height:"100%",borderLeft:"1px solid",borderLeftColor:e.colorSecondary,padding:20,display:"flex",flexDirection:"column"},children:[(0,l.jsx)(b,{chatHistory:h}),(0,l.jsx)(C,{message:s,handleMessageChange:e=>{d(e.target.value)},handleSendMessage:I})]})})]})]})]})}},6052:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return y}});var l=r(5893);r(7294);var n=r(9008),i=r.n(n),s=r(1274),o=r(9361),a=r(9356),d=r(1198),c=r(8100);let{Header:h,Sider:u,Content:f}=s.default,{useToken:x}=o.default;function y(){let{token:e}=x(),{user:t,isAuthenticated:r,loginWithRedirect:n,logout:o}=(0,c.D3)();return(0,l.jsxs)("div",{style:{height:"100vh"},children:[(0,l.jsxs)(i(),{children:[(0,l.jsx)("title",{children:"Study Oracle"}),(0,l.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,l.jsxs)(s.default,{style:{height:"100vh"},children:[(0,l.jsx)(h,{style:{backgroundColor:e.colorAccent},children:(0,l.jsx)(d.Z,{})}),(0,l.jsx)(s.default,{style:{height:"calc(100% - 64px)"},children:(0,l.jsx)(f,{style:{backgroundColor:e.colorBgBase},children:(0,l.jsx)("div",{style:{height:"100%",borderLeft:"1px solid",borderLeftColor:e.colorSecondary,padding:20,display:"flex",flexDirection:"column"},children:(0,l.jsx)(a.ZP,{id:"qsLoginBtn",color:"primary",block:!0,onClick:()=>n({}),children:"Log in"})})})})]})]})}}},function(e){e.O(0,[348,356,730,774,888,179],function(){return e(e.s=5557)}),_N_E=e.O()}]);